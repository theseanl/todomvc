/*
 Copyright (c) Microsoft Corporation. All rights reserved.
 Licensed under the Apache License, Version 2.0 (the "License"); you may not use
 this file except in compliance with the License. You may obtain a copy of the
 License at http://www.apache.org/licenses/LICENSE-2.0

 THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
 WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
 MERCHANTABLITY OR NON-INFRINGEMENT.

 See the Apache Version 2.0 License for specific language governing permissions
 and limitations under the License.
*/
function c(d,b){function a(){this.constructor=d}for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);d.prototype=null===b?Object.create(b):(a.prototype=b.prototype,new a)};var h=React;var l=ReactDOM;var m=function(){function d(){}d.U=function(){var b,a="";for(b=0;32>b;b++){var e=16*Math.random()|0;if(8===b||12===b||16===b||20===b)a+="-";a+=(12===b?4:16===b?e&3|8:e).toString(16)}return a};d.T=function(b){return 1===b?"item":"items"};d.store=function(b,a){return a?window.localStorage.setItem(b,JSON.stringify(a)):(b=window.localStorage.getItem(b))&&JSON.parse(b)||[]};d.extend=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];a={};for(var e=0;e<b.length;e++){var g=b[e],k;for(k in g)g.hasOwnProperty(k)&&
(a[k]=g[k])}return a};return d}();var p=function(){function d(b){this.key=b;this.c=m.store(b);this.D=[]}d.prototype.subscribe=function(b){this.D.push(b)};d.prototype.v=function(){m.store(this.key,this.c);this.D.forEach(function(b){b()})};d.prototype.G=function(b){this.c=this.c.concat({id:m.U(),title:b,h:!1});this.v()};d.prototype.B=function(b){this.c=this.c.map(function(a){return m.extend({},a,{h:b})});this.v()};d.prototype.toggle=function(b){this.c=this.c.map(function(a){return a!==b?a:m.extend({},a,{h:!a.h})});this.v()};d.prototype.A=
function(b){this.c=this.c.filter(function(a){return a!==b});this.v()};d.prototype.save=function(b,a){this.c=this.c.map(function(e){return e!==b?e:m.extend({},e,{title:a})});this.v()};d.prototype.w=function(){this.c=this.c.filter(function(b){return!b.h});this.v()};return d}();var r=classNames;var t=function(d){function b(){return null!==d&&d.apply(this,arguments)||this}c(b,d);b.prototype.render=function(){var a=m.T(this.props.count),e=null;0<this.props.H&&(e=h.createElement("button",{className:"clear-completed",onClick:this.props.O},"Clear completed"));var g=this.props.o;return h.createElement("footer",{className:"footer"},h.createElement("span",{className:"todo-count"},h.createElement("strong",null,this.props.count)," ",a," left"),h.createElement("ul",{className:"filters"},h.createElement("li",
null,h.createElement("a",{href:"#/",className:r({selected:"all"===g})},"All"))," ",h.createElement("li",null,h.createElement("a",{href:"#/active",className:r({selected:"active"===g})},"Active"))," ",h.createElement("li",null,h.createElement("a",{href:"#/completed",className:r({selected:"completed"===g})},"Completed"))),e)};return b}(h.Component);var u=function(d){function b(a){a=d.call(this,a)||this;a.state={j:a.props.l.title};return a}c(b,d);b.prototype.C=function(){var a=this.state.j.trim();a?(this.props.R(a),this.setState({j:a})):this.props.F()};b.prototype.K=function(){this.props.P();this.setState({j:this.props.l.title})};b.prototype.L=function(a){27===a.keyCode?(this.setState({j:this.props.l.title}),this.props.N(a)):13===a.keyCode&&this.C()};b.prototype.J=function(a){this.setState({j:a.target.value})};b.prototype.shouldComponentUpdate=
function(a,e){return a.l!==this.props.l||a.f!==this.props.f||e.j!==this.state.j};b.prototype.componentDidUpdate=function(a){!a.f&&this.props.f&&(a=l.findDOMNode(this.refs.editField),a.focus(),a.setSelectionRange(a.value.length,a.value.length))};b.prototype.render=function(){var a=this;return h.createElement("li",{className:r({h:this.props.l.h,f:this.props.f})},h.createElement("div",{className:"view"},h.createElement("input",{className:"toggle",type:"checkbox",checked:this.props.l.h,onChange:this.props.S}),
h.createElement("label",{onDoubleClick:function(){return a.K()}},this.props.l.title),h.createElement("button",{className:"destroy",onClick:this.props.F})),h.createElement("input",{ref:"editField",className:"edit",value:this.state.j,onBlur:function(){return a.C()},onChange:function(e){return a.J(e)},onKeyDown:function(e){return a.L(e)}}))};return b}(h.Component);var v=function(d){function b(a){a=d.call(this,a)||this;a.state={o:"all",f:null};return a}c(b,d);b.prototype.componentDidMount=function(){var a=this.setState;Router({"/":a.bind(this,{o:"all"}),"/active":a.bind(this,{o:"active"}),"/completed":a.bind(this,{o:"completed"})}).init("/")};b.prototype.M=function(a){13===a.keyCode&&(a.preventDefault(),a=l.findDOMNode(this.refs.newField).value.trim())&&(this.props.m.G(a),l.findDOMNode(this.refs.newField).value="")};b.prototype.B=function(a){this.props.m.B(a.target.checked)};
b.prototype.toggle=function(a){this.props.m.toggle(a)};b.prototype.A=function(a){this.props.m.A(a)};b.prototype.I=function(a){this.setState({f:a.id})};b.prototype.save=function(a,e){this.props.m.save(a,e);this.setState({f:null})};b.prototype.cancel=function(){this.setState({f:null})};b.prototype.w=function(){this.props.m.w()};b.prototype.render=function(){var a=this,e,g=this.props.m.c,k=g.filter(function(f){switch(a.state.o){case "active":return!f.h;case "completed":return f.h;default:return!0}}).map(function(f){return h.createElement(u,
{key:f.id,l:f,S:a.toggle.bind(a,f),F:a.A.bind(a,f),P:a.I.bind(a,f),f:a.state.f===f.id,R:a.save.bind(a,f),N:function(){return a.cancel()}})}),n=g.reduce(function(f,x){return x.h?f:f+1},0),q=g.length-n;if(n||q)var y=h.createElement(t,{count:n,H:q,o:this.state.o,O:function(){return a.w()}});g.length&&(e=h.createElement("section",{className:"main"},h.createElement("input",{id:"toggle-all",className:"toggle-all",type:"checkbox",onChange:function(f){return a.B(f)},checked:0===n}),h.createElement("label",
{htmlFor:"toggle-all"},"Mark all as complete"),h.createElement("ul",{className:"todo-list"},k)));return h.createElement("div",null,h.createElement("header",{className:"header"},h.createElement("h1",null,"todos"),h.createElement("input",{ref:"newField",className:"new-todo",placeholder:"What needs to be done?",onKeyDown:function(f){return a.M(f)},autoFocus:!0})),e,y)};return b}(h.Component),w=new p("react-todos");
function z(){l.render(h.createElement(v,{m:w}),document.getElementsByClassName("todoapp")[0])}w.subscribe(z);z();
